//Implement User Authentication for Custom API Integrations

from flask import Flask, request, jsonify
import jwt
import datetime

app = Flask(_name_)
app.config['SECRET_KEY'] = 'your_secret_key'

@app.route('/login', methods=['POST'])
def login():
    auth = request.json
    if auth['username'] == 'user' and auth['password'] == 'pass':  # Basic check
        token = jwt.encode({'user': auth['username'], 'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=1)}, app.config['SECRET_KEY'])
        return jsonify({'token': token})
    return 'Unauthorized', 401

@app.route('/protected', methods=['GET'])
def protected():
    token = request.args.get('token')
    try:
        data = jwt.decode(token, app.config['SECRET_KEY'], algorithms=["HS256"])
        return jsonify({'message': f'Welcome {data["user"]}'})
    except:
        return 'Token is invalid', 401

if _name_ == '_main_':
    app.run(debug=True)
